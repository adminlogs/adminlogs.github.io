<pre style="color:#000000;background:#ffffff;"><span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># mdadm --create /dev/md0 --level 5 --raid-disks 3 /dev/sd[b-d]</span>
mdadm<span style="color:#808030; ">:</span> partition table exists on <span style="color:#40015a; ">/dev/sdb</span>
mdadm<span style="color:#808030; ">:</span> partition table exists on <span style="color:#40015a; ">/dev/sdb</span> but will be lost or
meaningless after creating array
mdadm<span style="color:#808030; ">:</span> partition table exists on <span style="color:#40015a; ">/dev/sdc</span>
mdadm<span style="color:#808030; ">:</span> partition table exists on <span style="color:#40015a; ">/dev/sdc</span> but will be lost or
meaningless after creating array
mdadm<span style="color:#808030; ">:</span> partition table exists on <span style="color:#40015a; ">/dev/sdd</span>
mdadm<span style="color:#808030; ">:</span> partition table exists on <span style="color:#40015a; ">/dev/sdd</span> but will be lost or
meaningless after creating array
Continue creating array<span style="color:#808030; ">?</span> y
mdadm<span style="color:#808030; ">:</span> Defaulting to version <span style="color:#008c00; ">1</span><span style="color:#800000; font-weight:bold; ">.</span><span style="color:#008c00; ">2</span> metadata
mdadm<span style="color:#808030; ">:</span> array <span style="color:#40015a; ">/dev/md0</span> started<span style="color:#800000; font-weight:bold; ">.</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># watch cat /proc/mdstat</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># pvcreate /dev/md0</span>
Physical volume <span style="color:#0000e6; ">"</span><span style="color:#40015a; ">/dev/md0</span><span style="color:#0000e6; ">"</span> successfully created<span style="color:#800000; font-weight:bold; ">.</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># pvdisplay /dev/md0</span>
<span style="color:#0000e6; ">"</span><span style="color:#40015a; ">/dev/md0</span><span style="color:#0000e6; ">"</span> is a new physical volume of <span style="color:#0000e6; ">"15.98 GiB"</span>
--- NEW Physical volume ---
PV Name <span style="color:#40015a; ">/dev/md0</span>
VG Name
PV Size <span style="color:#008c00; ">15</span><span style="color:#800000; font-weight:bold; ">.</span><span style="color:#008c00; ">98</span> GiB
Allocatable NO
PE Size <span style="color:#008c00; ">0</span>
Total PE <span style="color:#008c00; ">0</span>
Free PE <span style="color:#008c00; ">0</span>
Allocated PE <span style="color:#008c00; ">0</span>
PV UUID QsHJGB-hDEE-8nAT-XiS7-IItH-8Je1-kVuYgx

<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># vgcreate lvmraidvg /dev/md0</span>
Volume group <span style="color:#0000e6; ">"lvmraidvg"</span> successfully created
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># vgdisplay lvmraidvg</span>
--- Volume group ---
VG Name lvmraidvg
System ID
Format lvm2
Metadata Areas <span style="color:#008c00; ">1</span>
Metadata Sequence No <span style="color:#008c00; ">1</span>
VG Access <span style="color:#40015a; ">read/write</span>
VG Status resizable
MAX LV <span style="color:#008c00; ">0</span>
Cur LV <span style="color:#008c00; ">0</span>
Open LV <span style="color:#008c00; ">0</span>
Max PV <span style="color:#008c00; ">0</span>
Cur PV <span style="color:#008c00; ">1</span>
Act PV <span style="color:#008c00; ">1</span>
VG Size <span style="color:#008c00; ">15</span><span style="color:#800000; font-weight:bold; ">.</span><span style="color:#008c00; ">98</span> GiB
PE Size <span style="color:#008c00; ">4</span><span style="color:#800000; font-weight:bold; ">.</span><span style="color:#008c00; ">00</span> MiB
Total PE <span style="color:#008c00; ">4091</span>
Alloc PE / Size <span style="color:#008c00; ">0</span> / <span style="color:#008c00; ">0</span>
Free PE / Size <span style="color:#008c00; ">4091</span> / <span style="color:#008c00; ">15</span><span style="color:#800000; font-weight:bold; ">.</span><span style="color:#008c00; ">98</span> GiB
VG UUID pYWf2Y-5j3b-pKlW-LaCL-mr36-KBBv-TWi3jN

<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># lvcreate -n lvmraidlv -l 50%VG lvmraidvg</span>
Logical volume <span style="color:#0000e6; ">"lvmraidlv"</span> created<span style="color:#800000; font-weight:bold; ">.</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># lvdisplay /dev/lvmraidvg/lvmraidlv</span>
--- Logical volume ---
LV Path <span style="color:#40015a; ">/dev/lvmraidvg/lvmraidlv</span>
LV Name lvmraidlv
VG Name lvmraidvg
LV UUID EMZJLD-v3P4-5wJo-TqB2-tOQv-1SuQ-80Ixka
LV Write Access <span style="color:#40015a; ">read/write</span>
LV Creation host, <span style="color:#800000; font-weight:bold; ">time</span> localhost<span style="color:#800000; font-weight:bold; ">.</span>localdomain, <span style="color:#008c00; ">2021</span>-<span style="color:#008c00; ">04</span>-<span style="color:#008c00; ">08</span> <span style="color:#008c00; ">21</span><span style="color:#808030; ">:</span><span style="color:#008c00; ">35</span><span style="color:#808030; ">:</span><span style="color:#008c00; ">08</span> +<span style="color:#008c00; ">0100</span>
LV Status available
<span style="color:#696969; "># open 0</span>
LV Size <span style="color:#e34adc; ">&lt;</span><span style="color:#008c00; ">7</span><span style="color:#800000; font-weight:bold; ">.</span><span style="color:#008c00; ">99</span> GiB
Current LE <span style="color:#008c00; ">2045</span>
Segments <span style="color:#008c00; ">1</span>
Allocation inherit
Read ahead sectors auto
- currently <span style="color:#bb7977; font-weight:bold; ">set</span> to <span style="color:#008c00; ">8192</span>
Block device <span style="color:#008c00; ">253</span><span style="color:#808030; ">:</span><span style="color:#008c00; ">2</span>

<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># dd if=/dev/urandom of=/boot/keyfile bs=1K count=1</span>
<span style="color:#008c00; ">1</span>+<span style="color:#008c00; ">0</span> records <span style="color:#800000; font-weight:bold; ">in</span>
<span style="color:#008c00; ">1</span>+<span style="color:#008c00; ">0</span> records out
<span style="color:#008c00; ">1024</span> bytes <span style="color:#800080; ">(</span><span style="color:#008c00; ">1</span><span style="color:#800000; font-weight:bold; ">.</span><span style="color:#008c00; ">0</span> kB, <span style="color:#008c00; ">1</span><span style="color:#800000; font-weight:bold; ">.</span><span style="color:#008c00; ">0</span> KiB<span style="color:#800080; ">)</span> copied, <span style="color:#008c00; ">0</span><span style="color:#800000; font-weight:bold; ">.</span><span style="color:#008c00; ">000336448</span> s, <span style="color:#008c00; ">3</span><span style="color:#800000; font-weight:bold; ">.</span><span style="color:#008c00; ">0</span> <span style="color:#40015a; ">MB/s</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># chmod 400 /boot/keyfile</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># cryptsetup luksFormat /dev/lvmraidvg/lvmraidlv</span>

WARNING<span style="color:#800000; font-weight:bold; ">!</span>
========
This will overwrite data on <span style="color:#40015a; ">/dev/lvmraidvg/lvmraidlv</span> irrevocably<span style="color:#800000; font-weight:bold; ">.</span>

Are you sure<span style="color:#808030; ">?</span> <span style="color:#800080; ">(</span>Type <span style="color:#0000e6; ">'yes'</span> <span style="color:#800000; font-weight:bold; ">in</span> capital letters<span style="color:#800080; ">)</span><span style="color:#808030; ">:</span> YES
Enter passphrase <span style="color:#800000; font-weight:bold; ">for</span> <span style="color:#40015a; ">/dev/lvmraidvg/lvmraidlv</span><span style="color:#808030; ">:</span>
Verify passphrase<span style="color:#808030; ">:</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># cryptsetup luksOpen /dev/lvmraidvg/lvmraidlv cryptedpart</span>
Enter passphrase <span style="color:#800000; font-weight:bold; ">for</span> <span style="color:#40015a; ">/dev/lvmraidvg/lvmraidlv</span><span style="color:#808030; ">:</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># cryptsetup luksAddKey /dev/lvmraidvg/lvmraidlv /boot/keyfile</span>
Enter any existing passphrase<span style="color:#808030; ">:</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># vi /etc/crypttab</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># cat /etc/crypttab</span>
cryptedpart <span style="color:#40015a; ">/dev/lvmraidvg/lvmraidlv</span> <span style="color:#40015a; ">/boot/keyfile</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># mkfs.ext4 /dev/mapper/cryptedpart</span>
mke2fs <span style="color:#008c00; ">1</span><span style="color:#800000; font-weight:bold; ">.</span><span style="color:#008c00; ">45</span><span style="color:#800000; font-weight:bold; ">.</span><span style="color:#008c00; ">6</span> <span style="color:#800080; ">(</span><span style="color:#008c00; ">20</span>-Mar-<span style="color:#008c00; ">2020</span><span style="color:#800080; ">)</span>
Creating filesystem with <span style="color:#008c00; ">2089984</span> 4k blocks and <span style="color:#008c00; ">523264</span> inodes
Filesystem UUID<span style="color:#808030; ">:</span> b42b22ff-f0bb-4ef2-<span style="color:#008c00; ">8290</span>-35e0c66fb8f7
Superblock backups stored on blocks<span style="color:#808030; ">:</span>
<span style="color:#008c00; ">32768</span>, <span style="color:#008c00; ">98304</span>, <span style="color:#008c00; ">163840</span>, <span style="color:#008c00; ">229376</span>, <span style="color:#008c00; ">294912</span>, <span style="color:#008c00; ">819200</span>, <span style="color:#008c00; ">884736</span>, <span style="color:#008c00; ">1605632</span>

Allocating group tables<span style="color:#808030; ">:</span> <span style="color:#800000; font-weight:bold; ">done</span>
Writing inode tables<span style="color:#808030; ">:</span> <span style="color:#800000; font-weight:bold; ">done</span>
Creating journal <span style="color:#800080; ">(</span><span style="color:#008c00; ">16384</span> blocks<span style="color:#800080; ">)</span><span style="color:#808030; ">:</span> <span style="color:#800000; font-weight:bold; ">done</span>
Writing superblocks and filesystem accounting information<span style="color:#808030; ">:</span> <span style="color:#800000; font-weight:bold; ">done</span>

<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># mkdir /secured</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># vi /etc/fstab</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># cat /etc/fstab</span>

<span style="color:#696969; ">#</span>
<span style="color:#696969; "># /etc/fstab</span>
<span style="color:#696969; "># Created by anaconda on Thu Oct 10 19:59:02 2019</span>
<span style="color:#696969; ">#</span>
<span style="color:#696969; "># Accessible filesystems, by reference, are maintained under '/dev/disk/'.</span>
<span style="color:#696969; "># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info.</span>
<span style="color:#696969; ">#</span>
<span style="color:#696969; "># After editing this file, run 'systemctl daemon-reload' to update systemd</span>
<span style="color:#696969; "># units generated from this file.</span>
<span style="color:#696969; ">#</span>
<span style="color:#40015a; ">/dev/mapper/cl-root</span> / xfs defaults <span style="color:#008c00; ">0</span> <span style="color:#008c00; ">0</span>
<span style="color:#797997; ">UUID</span><span style="color:#808030; ">=</span>de5581b0-03a4-4e5d-9d5c-ea380355dbde <span style="color:#40015a; ">/boot</span> ext4 defaults <span style="color:#008c00; ">1</span> <span style="color:#008c00; ">2</span>
<span style="color:#40015a; ">/dev/mapper/cl-swap</span> swap swap defaults <span style="color:#008c00; ">0</span> <span style="color:#008c00; ">0</span>
<span style="color:#40015a; ">/dev/mapper/cryptedpart</span> <span style="color:#40015a; ">/secured</span> ext4 defaults,usrquota,grpquota <span style="color:#008c00; ">0</span> <span style="color:#008c00; ">0</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># mount -a</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># ls -l /secured/</span>
total <span style="color:#008c00; ">16</span>
drwx------<span style="color:#800000; font-weight:bold; ">.</span> <span style="color:#008c00; ">2</span> root root <span style="color:#008c00; ">16384</span> Apr <span style="color:#008c00; ">9</span> <span style="color:#008c00; ">03</span><span style="color:#808030; ">:</span><span style="color:#008c00; ">02</span> lost+found
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@localhost ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># semanage fcontext -a -e / /secured</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@localhost ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># ls -dZ /</span>
system_u<span style="color:#808030; ">:</span>object_r<span style="color:#808030; ">:</span>root_t<span style="color:#808030; ">:</span>s0 /
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@localhost ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># ls -dZ /secured/</span>
system_u<span style="color:#808030; ">:</span>object_r<span style="color:#808030; ">:</span>unlabeled_t<span style="color:#808030; ">:</span>s0 <span style="color:#40015a; ">/secured</span><span style="color:#40015a; ">/</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@localhost ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># touch /.autorelabel</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@localhost ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># reboot</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@localhost ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># ls -dZ /secured/</span>
system_u<span style="color:#808030; ">:</span>object_r<span style="color:#808030; ">:</span>root_t<span style="color:#808030; ">:</span>s0 <span style="color:#40015a; ">/secured</span><span style="color:#40015a; ">/</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@localhost ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># mkdir /secured/home</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@localhost ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># ls -Z /secured/</span>
unconfined_u<span style="color:#808030; ">:</span>object_r<span style="color:#808030; ">:</span>default_t<span style="color:#808030; ">:</span>s0 home system_u<span style="color:#808030; ">:</span>object_r<span style="color:#808030; ">:</span>lost_found_t<span style="color:#808030; ">:</span>s0 lost+found
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@localhost ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># touch /.autorelabel</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@localhost ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># reboot</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@localhost ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># ls -Z /secured</span>
unconfined_u<span style="color:#808030; ">:</span>object_r<span style="color:#808030; ">:</span>home_root_t<span style="color:#808030; ">:</span>s0 home system_u<span style="color:#808030; ">:</span>object_r<span style="color:#808030; ">:</span>lost_found_t<span style="color:#808030; ">:</span>s0 lost+found
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># useradd -d /secured/home/sysadmin -u 10000 -s /bin/zsh abel</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># ls -lZ /secured/home/</span>
total <span style="color:#008c00; ">4</span>
drwx------<span style="color:#800000; font-weight:bold; ">.</span> <span style="color:#008c00; ">2</span> abel abel unconfined_u<span style="color:#808030; ">:</span>object_r<span style="color:#808030; ">:</span>user_home_dir_t<span style="color:#808030; ">:</span>s0 <span style="color:#008c00; ">4096</span> Apr <span style="color:#008c00; ">9</span> <span style="color:#008c00; ">08</span><span style="color:#808030; ">:</span><span style="color:#008c00; ">18</span> sysadmin
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># grep abel /etc/passwd</span>
abelx10000<span style="color:#808030; ">:</span><span style="color:#008c00; ">10000</span><span style="color:#808030; ">:</span><span style="color:#808030; ">:</span><span style="color:#40015a; ">/secured/home/sysadmin</span><span style="color:#808030; ">:</span><span style="color:#40015a; ">/bin/zsh</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># groupadd -g 20000 administrators</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># grep administrators /etc/group</span>
administratorsx20000<span style="color:#808030; ">:</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># usermod -aG administrators abel</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># grep administrators /etc/group</span>
administratorsx20000<span style="color:#808030; ">:</span>abel
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># useradd -u 10001 -d /secured/home/netadmin -s /bin/zsh adel</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># grep adel /etc/passwd</span>
adel<span style="color:#808030; ">:</span>x<span style="color:#808030; ">:</span><span style="color:#008c00; ">10001</span><span style="color:#808030; ">:</span><span style="color:#008c00; ">10001</span><span style="color:#808030; ">:</span><span style="color:#808030; ">:</span><span style="color:#40015a; ">/secured/home/netadmin</span><span style="color:#808030; ">:</span><span style="color:#40015a; ">/bin/zsh</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># usermod -aG administrators adel</span>
<span style="color:#808030; ">[</span><span style="color:#0000e6; ">root@public ~</span><span style="color:#808030; ">]</span><span style="color:#696969; "># grep administrators /etc/group</span>
administrators<span style="color:#808030; ">:</span>x<span style="color:#808030; ">:</span><span style="color:#008c00; ">20000</span><span style="color:#808030; ">:</span>abel,adel
</pre>

