<pre>
VPN Technologies:
  - remote Access VPNs
   - site-to-site VPNs:
    Design:
    - Hub-and-Spoke design
    - Spoke-to-Spoke design
    - Full Mesh design
    - Hybrid design
    - Tiered Hub-and-Spoke design
    Type:
    - GETVPN                                  cisco routers only
    - DMVPN:              tunnel-less         cisco routers only
    - GRE-Based VPN:      tunnel-less         cisco routers only
    - Easy VPN:           tunnel-based        cisco asa 5500 series, cisco vpn 3000 series, and cisco pix firewalls
    - Standard IPsec VPN: tunnel-based        multivendorsPacket
CIA: Confidentiality Integrity Authentication
IPSec:
  AH:
  IP/51
  RFC 3402 Authentication Header          digitaly sign an IP packet / Authentication
    Authenticate the entire IP packet
      transport mode:
        IP|AH header|TCP|Data
      tunnel mode:
        new IP header|AH header|IP|TCP|Data
  ESP:
  IP/50
  RFC 3403 Encapsulation Security Packet  encrypt an IP Packet       / Authentication & Confidentiality
    Authenticate only the IP datagram portion of the IP packet
    transport mode:
        IP|ESP header|TCP|Data|ESP trailer|ESP auth
      tunnel mode:
        new IP header|ESP header|IP|TCP|Data|ESP trailer|ESP auth
  ISAKMP:
     UDP/500
    Internet Security Association and Key Management Protocol IKE RFC 7296 , now also specified as part of the IKE protocol suite
    ISAKMP defines how security associations (SAs) are set up and used to define direct connections between two hosts that are using IPsec
  IKE Phase 1: is the IKE negociation
  IKE Phase 2: is the IPSec  SA exchange
  IKEv1
  IKEv2
  IKE data flow:
    Phase 1:
      IKE policy negociation
      DH
      authenticatio
    Phase 2:
      IPSec SA exchange
    Data flow:
      Data flow
</pre>
GETVPN: Group Encrypted Transport VPN
  In a GETVPN setup, there isnâ€™t a need to negotiate point-to-point IPsec tunnels between members of a group; this means GETVPN is a tunnel-less option.
DMVPN: Dynamic Multipoint VPN (DMVPN)
  mGRE Multipoint GRE
FlexVPN:
  Cisco version of the IKEv2 standard offering for both site-to-site and remote access VPNs.
<h3>GETVPN Group Encrypted Transport VPN:</h3>
<p>
  Resolve the problem of the large number of security associations (SAs), GETVPN uses a single SA for all the group members. Using a single SA eliminates the hub-and-spoke solutions and partial mesh configurations. GETVPN protocol GDOI Group Domain Of Interpretation establishes the SA between the group members.
  GETVPN introduces the concept of <b>trusted group</b>, each VPN router in the trusted group trusts the other routers nad can send traffic to them. All the group members share the a common SA, this results in two distinct important advantages for GETVPN:
    Any group member can decrypt traffic encrypted by any other member.
    Tunnel negociation is not required because GETVPN is a non-tunnel/tunnel-less based solution.
</p>
  <h4>GDOI(Group Domain Of Interest) Protocol:</h4>
<p>
   RFC 6407, in GETVPN the router encrypts the payload and transmits the IP datagram with the original source and destination IP addresses.
</p>
   Original IP Packet:
   <pre>
   |           |            |
   | IP Header | IP Payload |
   |           |            |
   IPSec Site-to-Site Packet
   |               |            |                    |            |
   | New IP Header | ESP Header | Original IP Header | IP Payload |
   |               |            |                    |            |
   GETVPN IP Packet
   |                    |            |                    |            |
   | Original IP Header | ESP Header | Original IP Header | IP Payload |
   |                    |            |                    |            |
   </pre>
  <p>
  GETVPN does not work in NAT environment, tis type of solution is rarely used across the public network such the internet. GETVPN is ideally suited for either MPLS network or a private IP netwok implementation in large entreprises and government entities.
  GETVPN supports IKEv1 and IKEv2.
  GETVPN has three primary components:
    Key Server.
    Group member.
    GDOI protocol.
<h4>Key Server</h4>
Is the most critical device in the GETPVN solution. The minimal components that should be configured on a key server:
<ul>
<li>IKE policy</li>
<li>RSA key for rekeying</li>
<li>IPSec policies</li>
<li>Traffic classification</li>
</ul>
<p>
Key Server is responsible for registering the group emebers, sending out encryption keys and rekeying process that  occurs periodicaly.
It cannot be a group member, GETVPN needs at least one Key Server. Key Server uses the protocol GDOI to communicate with the group members.
<p>
</p>
Upon initialization, a group member registers with the Key Server by using a preshared key or certification PKI. Once a group member is authorized it retrieves the policy configuration and the two keys used for communication with other group members. The Key Server is responsible for maintaining the SA policy, authenticate group members ans provifding session keys for encrypting/decryptig traffic.
Key Server provides two keys for group members:
</p>
<ul>
<li>key encryption key (KEK) protects control plane communication such as rekeying process</li>
<li>traffic encryption key (TEK) responsible for payload encryption between group members, it  supports the IPSec SA that all group members use to encrypt/decryp payloads</li>
</ul>
</p>
  <h4>Group Member</h4>
<p>
  Policy and SA information are retrieved from the Key Server, during the registration the group member provides ID to get the Policy and the keys.
</p>
<p>A group member is a VPN router that is member of GDOI group and can encrypt traffic being sent to any memeber other member since the all use the same IPSec SA.</p>
<p>A fault tolerance is  having a single Key Server, it is possible to have upto 8 Key Servers per group. A group member register to one Server Key, and then the Key Server replicates that information to the primary Key Server The primary Key Server is responsible for maintaining the database of all registered group members and the rekeying synchronization process.</p>
<h4>GETVPN GDOI Protocol</h4>
<p>
Is used as communication mechanusm between the key servers and group members in the VPN. It is protected by IKE phase 1. KEK is useed when the key server pushes a new key to the group members. The key server can use multicast to push the keys or notify them ot the rekeying.
</p>
<h4>GETVPN Security Controls</h4>
<h5>Rekeying</h5>
<p>configured on the key server, is a policy that is pushed out to the group members using KEK before the existing key expires.</p>p
<h5>TBAR (Time Based Anti-Replay)</h5>
<p> It is a pseudo time clock established for the group and managed by the key server.</p>
<h5>P-D3P (IP-Delivery Delay Detection Protocol)</h5>
<p> Is designed to address IP delivery delay attacks</p>
